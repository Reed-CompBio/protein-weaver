<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Oliver Anderson, Altaf Barelvi, Anna Ritz" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Setup - ProteinWeaver Docs</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Setup";
        var mkdocs_page_input_path = "setup.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> ProteinWeaver Docs
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Setup</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#backend-database">Backend Database</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#d-melanogaster-imports">D. melanogaster imports</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#b-subtilis-imports">B. subtilis imports</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#d-rerio-imports">D. rerio imports</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#gene-ontology-hierarchy-imports">Gene Ontology hierarchy imports</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#propogation-of-ancestral-progo-edges">Propogation of ancestral ProGo edges</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#backend-server">Backend Server</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#frontend-client">Frontend Client</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#verify-guide">Verify Guide</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#useful-commands">Useful Commands</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../data-version/">Data Log & Version</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../tech-stack/">Tech Stack</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../contributing-guide/">Contributing Guide</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">ProteinWeaver Docs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Setup</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="setup">Setup</h1>
<p>The setup guide will include instructions for creating the front and backenbd local dev environments (database, server, and client).</p>
<h2 id="backend-database">Backend Database</h2>
<p>ProteinWeaver uses a Dockerized version of Neo4j as the database. <a href="https://docs.docker.com/get-docker/">Follow these instructions</a> to install Docker Desktop. Once installed continue with the following steps:</p>
<ol>
<li>
<p>Pull the official Neo4j Docker image in terminal:
<code>docker pull neo4j</code></p>
</li>
<li>
<p>Create a directory in your <code>$HOME</code> named <code>neo4j</code></p>
<ul>
<li>Within <code>~/neo4j</code> directory create the following directories:<ul>
<li><code>~/neo4j/data/</code> to allow storage of database state between Docker instances</li>
<li><code>~/neo4j/logs/</code> to allow storage of logs between Docker instances</li>
<li><code>~/neo4j/import/</code> to store data for import</li>
<li><code>~/neo4j/plugins/</code> to store any necessary plugins for production environments</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Download the most recent datasets from the <a href="https://github.com/Reed-CompBio/protein-weaver/blob/main/data/Import/"><code>/import</code></a> directory on GitHub and place them inside of your <code>~/neo4j/import/</code> local directory. These are all the prerequisite files you will need for this tutorial and will be updated as new versions are released.</p>
</li>
<li>
<p>Create a Docker instance with GDS and APOC plugins using the following command:</p>
<pre><code>```bash
docker run \
    --name proteinweaver \
    -p7474:7474 -p7687:7687 \
    -v $HOME/neo4j/data:/data \
    -v $HOME/neo4j/logs:/logs \
    -v $HOME/neo4j/import:/import \
    -v $HOME/neo4j/plugins:/plugins \
    --env NEO4J_AUTH=none \
    -e NEO4J_apoc_export_file_enabled=true \
    -e NEO4J_apoc_import_file_enabled=true \
    -e NEO4J_apoc_import_file_use__neo4j__config=true \
    -e NEO4J_PLUGINS='["graph-data-science"]' \
    -e NEO4JLABS_PLUGINS=\[\"apoc\"\] \
    neo4j:5.12.0-community-bullseye
```
</code></pre>
<ul>
<li>This example Docker instance has no security restrictions, to set a username and password edit this line in the previous command:
    <code>--env NEO4J_AUTH=username/password</code></li>
</ul>
</li>
<li>
<p>Access the Docker image at <a href="http://localhost:7474">http://localhost:7474</a>. You will need to input the username and password you defined in the <code>run</code> command.</p>
</li>
<li>
<p>Create constraints before data import. We use NCBI as the source of the unique taxon identifiers:</p>
<pre><code>```cypher
CREATE CONSTRAINT txid_constraint FOR (n:protein) REQUIRE (n.txid, n.id) IS UNIQUE;
CREATE CONSTRAINT go_constraint FOR (n:go_term) REQUIRE n.id IS UNIQUE;
```
</code></pre>
</li>
</ol>
<h5 id="d-melanogaster-imports"><em>D. melanogaster</em> imports</h5>
<ol>
<li>
<p>Import <em>D. melanogaster</em> <a href="https://github.com/Reed-CompBio/protein-weaver/blob/main/data/Import/interactome-flybase-collapsed-weighted.txt">protein interactome</a> using the following command:</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///interactome-flybase-collapsed-weighted.txt' AS fly
FIELDTERMINATOR '\t'
CALL {
    with fly
    MERGE (a:protein {id: fly.FlyBase1, name: fly.symbol1, txid: "txid7227", species: "Drosophila melanogaster"})
    MERGE (b:protein {id: fly.FlyBase2, name: fly.symbol2, txid: "txid7227", species: "Drosophila melanogaster"})
    MERGE (a)-[r:ProPro]-(b)
} IN TRANSACTIONS OF 100 ROWS;
```
</code></pre>
</li>
<li>
<p>Set the alt_name parameter as the same as the name.</p>
<pre><code>```cypher
MATCH (n:protein {txid: "txid7227"}) SET n.alt_name = n.name;
```
</code></pre>
</li>
<li>
<p>Set Pubmed identifiers as property on ProPro edges.</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///interactome-flybase-collapsed-weighted.txt' AS fly
FIELDTERMINATOR '\t'
CALL {
    with fly
    MATCH (p:protein {id: fly.FlyBase1})-[r:ProPro]-(p2:protein {id: fly.FlyBase2})
    SET r.pubmed = fly.PubMedIDs
} IN TRANSACTIONS OF 1000 ROWS;
```
</code></pre>
</li>
<li>
<p>Import gene regulatory interactions from FlyBase for <em>D. melanogaster</em>.</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///regulatory_txid7227_2024-07-31.txt' AS dmel_reg
FIELDTERMINATOR '\t'
CALL {
        with dmel_reg
        MERGE (a:protein {id: dmel_reg.Interacting_gene_FBgn, txid: "txid7227", species: "Drosophila melanogaster"})
        MERGE (b:protein {id: dmel_reg.Starting_gene_FBgn, txid: "txid7227", species: "Drosophila melanogaster"})
        MERGE (a)-[r:Reg]-&gt;(b)
        SET r.relationship = dmel_reg.Interaction_type,
        r.link = dmel_reg.Publication_FBrf,
        a.gene_name = dmel_reg.Interacting_gene_symbol,
        b.gene_name = dmel_reg.Starting_gene_symbol
} IN TRANSACTIONS OF 100 ROWS;
```
</code></pre>
</li>
<li>
<p>Import the first batch of <em>D. melanogaster</em> <a href="https://github.com/Reed-CompBio/protein-weaver/blob/main/data/Import/gene_association_fb_2024-04-03.tsv">GO data from FlyBase</a> into the database using the following command:</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///gene_association_fb_2024-04-03.tsv' AS flygo
FIELDTERMINATOR '\t'
CALL {
    with flygo
    MATCH (n:protein {id: flygo.db_object_id, txid:"txid7227"})
    MERGE (g:go_term {id: flygo.go_id})
    MERGE (n)-[r:ProGo]-(g)
} IN TRANSACTIONS OF 1000 ROWS;
```
</code></pre>
</li>
<li>
<p>Import the relationships qualifiers for the first batch of GO terms and <em>D. melanogaster</em> proteins using the following commands:</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///gene_association_fb_2024-04-03.tsv' AS flygo
FIELDTERMINATOR '\t'
CALL {
    with flygo
    MATCH (p:protein {id: flygo.db_object_id, txid:"txid7227"})-[r:ProGo]-(g:go_term {id: flygo.go_id})
    SET r.relationship = flygo.qualifier
} IN TRANSACTIONS OF 1000 ROWS;
```
</code></pre>
</li>
<li>
<p>Import more <a href="https://github.com/Reed-CompBio/protein-weaver/blob/main/data/Import/dmel_GO_data_2024-04-03.tsv">GO data</a> for <em>D. melanogaster</em>.</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///dmel_GO_data_2024-04-03.tsv' AS dmelgo
FIELDTERMINATOR '\t'
CALL {
    with dmelgo
    MATCH (n:protein {id: dmelgo.FB_ID, txid: "txid7227"})
    MERGE (g:go_term {id: dmelgo.GO_TERM})
    MERGE (n)-[r:ProGo]-(g)
} IN TRANSACTIONS OF 1000 ROWS;
```
</code></pre>
</li>
<li>
<p>Set second batch of qualifier properties for <em>D. melanogaster</em>.</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///dmel_GO_data_2024-04-03.tsv' AS dmelgo
FIELDTERMINATOR '\t'
CALL {
    with dmelgo
    MATCH (p:protein {id: dmelgo.FB_ID, txid: "txid7227"})-[r:ProGo]-(g:go_term {id: dmelgo.GO_TERM})
    SET r.relationship = dmelgo.QUALIFIER
} IN TRANSACTIONS OF 1000 ROWS;
```
</code></pre>
</li>
</ol>
<h5 id="b-subtilis-imports"><em>B. subtilis</em> imports</h5>
<ol>
<li>
<p>Import <em>B. subtilis</em> <a href="https://github.com/Reed-CompBio/protein-weaver/blob/main/data/Import/file:///bsub_interactome_2024-05-31.txt">protein interactome</a> with the following command:</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///interactome_txid224308_2024-07-30.txt' AS bsub
FIELDTERMINATOR '\t'
CALL {
with bsub
MERGE (a:protein {id: bsub.protein_1_locus, name: bsub.protein_1_name, alt_name: bsub.protein_1_alt_name, txid: "txid224308", species: "Bacillus subtilis 168"})
MERGE (b:protein {id: bsub.protein_2_locus, name: bsub.protein_2_name, alt_name: bsub.protein_2_alt_name, txid: "txid224308", species: "Bacillus subtilis 168"})
MERGE (a)-[r:ProPro]-(b)
} IN TRANSACTIONS OF 100 ROWS;
```
</code></pre>
</li>
<li>
<p>Add property to edges that links to STRING-DB entrance for interaction.</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///interactome_txid224308_2024-07-30.txt' AS bsub
FIELDTERMINATOR '\t'
CALL {
    with bsub
    MATCH (p:protein {id: bsub.protein_1_locus})-[r:ProPro]-(p2:protein {id: bsub.protein_2_locus})
    SET r.link = bsub.link,
    r.source = bsub.source
} IN TRANSACTIONS OF 1000 ROWS;        
```
</code></pre>
</li>
<li>
<p>Add regulatory data for <em>B. subtilis</em>:</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///regulatory_txid224308_2024-07-31.txt' AS bsub
FIELDTERMINATOR '\t'
CALL {
        with bsub
        MERGE (a:protein {id: bsub.regulator_locus, txid: "txid224308", species: "Bacillus subtilis 168"})
        MERGE (b:protein {id: bsub.gene_locus, txid: "txid224308", species: "Bacillus subtilis 168"})
        MERGE (a)-[r:Reg]-&gt;(b)
        SET r.relationship = bsub.mode,
        r.link = bsub.link,
        a.gene_name = bsub.regulator_name,
        b.gene_name = bsub.gene_name
} IN TRANSACTIONS OF 100 ROWS;
```
</code></pre>
</li>
<li>
<p>Add first batch of <a href="https://github.com/Reed-CompBio/protein-weaver/blob/main/data/Import/bsub_GO_data.csv">GO data from SubtiWiki</a> to <em>B. subtilis</em> nodes:</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///bsub_GO_data.csv' AS bsubgo
CALL {
    with bsubgo
    MATCH (n:protein {id: bsubgo.locus, txid: "txid224308"})
    MERGE (g:go_term {id: bsubgo.go_term})
    MERGE (n)-[r:ProGo]-(g)
} IN TRANSACTIONS OF 1000 ROWS;
```
</code></pre>
</li>
<li>
<p>Set qualifier property from first batch of GO data for <em>B. subtilis</em>.</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///bsub_GO_data.csv' AS bsubgo
CALL {
    with bsubgo
    MATCH (p:protein {id: bsubgo.locus, txid: "txid224308"})-[r:ProGo]-(g:go_term {id: bsubgo.go_term})
    SET r.relationship = bsubgo.qualifier
} IN TRANSACTIONS OF 1000 ROWS;
```
</code></pre>
</li>
<li>
<p>Import more <a href="https://github.com/Reed-CompBio/protein-weaver/blob/main/data/Import/annotations_txid224308_2024-06-03.txt">GO data</a> for <em>B. subtilis</em>.</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///annotations_txid224308_2024-06-03.txt' AS bsubgo
FIELDTERMINATOR '\t'
CALL {
    with bsubgo
    MATCH (n:protein {id: bsubgo.BSU_ID, txid: "txid224308"})
    MERGE (g:go_term {id: bsubgo.GO_TERM})
    MERGE (n)-[r:ProGo]-(g)
} IN TRANSACTIONS OF 1000 ROWS;
```
</code></pre>
</li>
<li>
<p>Set qualifier property for second batch of GO data (<em>B. subtilis</em>).</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///annotations_txid224308_2024-06-03.txt' AS bsubgo
FIELDTERMINATOR '\t'
CALL {
    with bsubgo
    MATCH (p:protein {id: bsubgo.BSU_ID, txid: "txid224308"})-[r:ProGo]-(g:go_term {id: bsubgo.GO_TERM})
    SET r.relationship = bsubgo.QUALIFIER
} IN TRANSACTIONS OF 1000 ROWS;
```
</code></pre>
</li>
</ol>
<h5 id="d-rerio-imports"><em>D. rerio</em> imports</h5>
<ol>
<li>
<p>Import <em>D. rerio</em> <a href="https://github.com/Reed-CompBio/protein-weaver/blob/main/data/Import/interactome_txid7955_2024-06-24.txt">protein interactome</a> with the following command:</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///interactome_txid7955_2024-07-30.txt' AS zfish
FIELDTERMINATOR '\t'
CALL {
    with zfish
    MERGE (a:protein {id: zfish.uniprotID1, name: zfish.name1, alt_name: zfish.alt_name1, txid: "txid7955", species: "Danio rerio"})
    MERGE (b:protein {id: zfish.uniprotID2, name: zfish.name2, alt_name: zfish.alt_name2, txid: "txid7955", species: "Danio rerio"})
    MERGE (a)-[r:ProPro]-(b)
} IN TRANSACTIONS OF 100 ROWS;
```
</code></pre>
</li>
<li>
<p>Add property to edges that links to STRING-DB entrance for interaction.</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///interactome_txid7955_2024-07-30.txt' AS zfish
FIELDTERMINATOR '\t'
CALL {
    with zfish
    MATCH (p:protein {id: zfish.uniprotID1})-[r:ProPro]-(p2:protein {id: zfish.uniprotID2})
    SET r.link = zfish.link, r.source = zfish.source
} IN TRANSACTIONS OF 1000 ROWS;        
```
</code></pre>
</li>
<li>
<p>Add regulatory data for <em>D. rerio</em>:</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///regulatory_txid7955_2024-07-31.txt' AS drer_reg
FIELDTERMINATOR '\t'
CALL {
        with drer_reg
        MERGE (a:protein {id: drer_reg.UniprotID_TF, txid: "txid7955", species: "Danio rerio"})
        MERGE (b:protein {id: drer_reg.UniprotID_Target, txid: "txid7955", species: "Danio rerio"})
        MERGE (a)-[r:Reg]-&gt;(b)
        SET r.relationship = "regulates",
        r.pubmed = drer_reg.PubmedID,
        a.gene_name = drer_reg.Name_TF,
        b.gene_name = drer_reg.Name_Target
} IN TRANSACTIONS OF 100 ROWS;
```
</code></pre>
</li>
<li>
<p>Add <a href="https://github.com/Reed-CompBio/protein-weaver/blob/main/data/Import/zfish_GO_data_2024-04-03.tsv">GO data</a> to <em>D. rerio</em> nodes:</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///zfish_GO_data_2024-04-03.tsv' AS zfishgo
FIELDTERMINATOR '\t'
CALL {
    with zfishgo
    MATCH (n:protein {id: zfishgo.GENE_PRODUCT_ID, txid: "txid7955"})
    MERGE (g:go_term {id: zfishgo.GO_TERM})
    MERGE (n)-[r:ProGo]-(g)
} IN TRANSACTIONS OF 1000 ROWS;
```
</code></pre>
</li>
<li>
<p>Set qualifier property for <em>D. rerio</em>.</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///zfish_GO_data_2024-04-03.tsv' AS zfishgo
FIELDTERMINATOR '\t'
CALL {
    with zfishgo
    MATCH (p:protein {id: zfishgo.GENE_PRODUCT_ID, txid: "txid7955"})-[r:ProGo]-(g:go_term {id: zfishgo.GO_TERM})
    SET r.relationship = zfishgo.QUALIFIER
} IN TRANSACTIONS OF 1000 ROWS;
```
</code></pre>
</li>
</ol>
<h5 id="gene-ontology-hierarchy-imports">Gene Ontology hierarchy imports</h5>
<ol>
<li>
<p>Import the <a href="https://github.com/Reed-CompBio/protein-weaver/blob/main/data/Import/is_a_import.tsv">GO hierarchy</a> with the following command:</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///is_a_import_2024-07-17.tsv' AS go
FIELDTERMINATOR '\t'
CALL {
    with go
    MERGE (a:go_term {id: go.id})
    MERGE (b:go_term {id: go.id2})
    MERGE (a)-[r:GoGo]-&gt;(b)
    SET r.relationship = go.is_a
} IN TRANSACTIONS OF 100 ROWS;
```
</code></pre>
</li>
<li>
<p>Import the <a href="https://github.com/Reed-CompBio/protein-weaver/blob/main/data/Import/go_2024-03-28.txt">GO term common names and descriptions</a> with the following Cypher command:</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///go_2024-07-17.txt' AS go
FIELDTERMINATOR '\t'
CALL {
    with go
    MATCH (n:go_term {id: go.id})
    SET n.name = go.name,
    n.namespace = go.namespace,
    n.def = go.def
} IN TRANSACTIONS OF 1000 ROWS;
```
</code></pre>
</li>
<li>
<p>Add blacklist indicator to GO term nodes:</p>
<pre><code>```cypher
:auto LOAD CSV WITH HEADERS FROM 'file:///go_2024-07-17.txt' AS go
FIELDTERMINATOR '\t'
CALL {
    with go
    MATCH (n:go_term {id: go.id})
    SET n.never_annotate = go.never_annotate
} IN TRANSACTIONS OF 1000 ROWS;
```
</code></pre>
</li>
</ol>
<h5 id="propogation-of-ancestral-progo-edges">Propogation of ancestral ProGo edges</h5>
<ol>
<li>
<p>Add ancestral edges for <em>D. rerio</em>.</p>
<pre><code>```cypher
MATCH (p:protein {txid: 'txid7955'})-[:ProGo]-(g:go_term)
WITH p, collect(g) AS go_terms

UNWIND go_terms as go_input
MATCH (p)-[:ProGo]-(g:go_term {id: go_input.id})-[:GoGo*]-&gt;(g2)
WITH p, collect(distinct g2) AS parent_terms
UNWIND parent_terms AS parent_term

MERGE (p)-[r:ProGo]-(parent_term)
```
</code></pre>
</li>
<li>
<p>Add ancestral edges for <em>B. subtilis</em>.</p>
<pre><code>```cypher
MATCH (p:protein {txid: 'txid224308'})-[:ProGo]-(g:go_term)
WITH p, collect(g) AS go_terms

UNWIND go_terms as go_input
MATCH (p)-[:ProGo]-(g:go_term {id: go_input.id})-[:GoGo*]-&gt;(g2)
WITH p, collect(distinct g2) AS parent_terms
UNWIND parent_terms AS parent_term

MERGE (p)-[r:ProGo]-(parent_term)
```
</code></pre>
</li>
<li>
<p>Add ancestral edges for <em>D. melanogaster</em>.</p>
<pre><code>```cypher
MATCH (p:protein {txid: 'txid7227'})-[:ProGo]-(g:go_term)
WITH p, collect(g) AS go_terms

UNWIND go_terms as go_input
MATCH (p)-[:ProGo]-(g:go_term {id: go_input.id})-[:GoGo*]-&gt;(g2)
WITH p, collect(distinct g2) AS parent_terms
UNWIND parent_terms AS parent_term

MERGE (p)-[r:ProGo]-(parent_term)
```
</code></pre>
</li>
<li>
<p>Add qualifiers for new ProGo edges for each species.</p>
<pre><code>```cypher
MATCH (p:protein  {txid: 'txid7227'})-[r:ProGo]-(g:go_term)
WHERE r.relationship IS NULL
SET r.relationship = "inferred_from_descendant"
```

```cypher
MATCH (p:protein {txid: 'txid224308'})-[r:ProGo]-(g:go_term)
WHERE r.relationship IS NULL
SET r.relationship = "inferred_from_descendant"
```

```cypher
MATCH (p:protein {txid: 'txid7955'})-[r:ProGo]-(g:go_term)
WHERE r.relationship IS NULL
SET r.relationship = "inferred_from_descendant"
```
</code></pre>
</li>
<li>
<p>Now remove all the Protein-Protein edges from the same protein to itself with the following command (these edges may causes issues with our path algorithms).</p>
<pre><code>```cypher
MATCH (p:protein)-[rel:ProPro]-(p) DETACH DELETE rel;
```
</code></pre>
</li>
<li>
<p>Now remove obsolete/disconnected GO terms:</p>
<pre><code>```cypher
MATCH (g:go_term)
WHERE NOT (g)-[:GoGo]-()
DETACH DELETE g
```
</code></pre>
</li>
<li>
<p>Now add the degree for all nodes for each species as a property:</p>
<pre><code>```cypher
MATCH (pr:protein{txid: "txid224308"})
SET pr.degree = COUNT{(pr)-[:ProPro]-(:protein)}

MATCH (pr:protein{txid: "txid7955"})
SET pr.degree = COUNT{(pr)-[:ProPro]-(:protein)}

MATCH (pr:protein{txid: "txid7227"})
SET pr.degree = COUNT{(pr)-[:ProPro]-(:protein)}
```
</code></pre>
</li>
<li>
<p>The last step is calling a graph projection for pathfinding algorithms. We also have to change the ProPro edges to be undirected for the pathfinding algorithms in order to be more biologically accurate for protein-protein interaction networks.</p>
<pre><code>```cypher
CALL gds.graph.project('proGoGraph',['go_term', 'protein'],['ProGo', 'ProPro', 'Reg']);
CALL gds.graph.relationships.toUndirected( 'proGoGraph', {relationshipType: 'ProPro', mutateRelationshipType: 'ProProUndirected'} ) YIELD   inputRelationships, relationshipsWritten;
```
</code></pre>
</li>
</ol>
<h2 id="backend-server">Backend Server</h2>
<p>The backend server is run using Express.js. To setup the server continue with the following steps:</p>
<ol>
<li>
<p>Open a new terminal window and clone the ProteinWeaver GitHub repository. Locate the <code>server</code> directory:</p>
<pre><code>```bash
cd server
```
</code></pre>
</li>
<li>
<p>Next we need to install <code>node.js</code>, and the recommended way is to use a Node Version Manager. Follow the <a href="https://github.com/nvm-sh/nvm">NVM GitHub</a> instructions before proceeding.</p>
</li>
<li>
<p>The correct version is outlined in the <code>.nvmrc</code> file in both of the client and server directories. Follow the command below to use the correct version.</p>
<pre><code>```bash
nvm use
```
</code></pre>
</li>
<li>
<p>If you do not have the correct version, install it with the following command:</p>
<pre><code>```bash
npm install
```
</code></pre>
</li>
<li>
<p>You can verify your node version is now correct with the following command:</p>
<pre><code>```bash
node -v
```
</code></pre>
</li>
<li>
<p>Finally, to start the server enter:</p>
<pre><code>```bash
npm start
```
</code></pre>
</li>
<li>
<p>The server should be running on <a href="http://localhost:3000/">http://localhost:3000/</a>. There are several APIs, and you can verify it works by using <a href="http://localhost:3000/api/test">http://localhost:3000/api/test</a> which should output a JSON object. Please keep the terminal window open.</p>
</li>
</ol>
<h2 id="frontend-client">Frontend Client</h2>
<p>The client uses the <code>React.js</code> framework, and uses <code>Vite.js</code> as a bundler.</p>
<ol>
<li>
<p>Open a new terminal window and navigate to the cloned ProteinWeaver Github repository. Locate the <code>client</code> directory with the following <code>bash</code> command:</p>
<pre><code>```bash
cd client
```
</code></pre>
</li>
<li>
<p>Similar to the backend server setup, we need to use and install the correct <code>node.js</code> version. Follow the command below to use the correct version.</p>
<pre><code>```bash
nvm use
```
</code></pre>
</li>
<li>
<p>If you do not have the correct version, install it with the following command:</p>
<pre><code>```bash
npm install
```
</code></pre>
</li>
<li>
<p>You can verify your node version is now correct with the following command:</p>
<pre><code>```bash
node -v
```
</code></pre>
</li>
<li>
<p>Lastly, start the client with the following command:</p>
<pre><code>```bash
npm run dev
```
</code></pre>
<p>ProteinWeaver should now be up and running on <a href="http://localhost:5173/">http://localhost:5173/</a>!</p>
</li>
</ol>
<h2 id="verify-guide">Verify Guide</h2>
<p>Once you have completed the guide, you can use the following query to verify that the database matches the most updated version (AS OF 2024-05-06):</p>
<pre><code>    ```cypher
    match (fly:protein {txid :"txid7227"})
    WITH COUNT(fly) AS flyCount
    match (bsub:protein {txid :"txid224308"})
    WITH flyCount, COUNT(bsub) AS bsubCount
    match (drerio:protein {txid :"txid7955"})
    WITH flyCount, bsubCount, COUNT(drerio) AS drerioCount
    match (go:go_term)
    WITH flyCount, bsubCount, drerioCount, COUNT(go) AS goCount
    match (fly1 {txid :"txid7227"}) -[flyProPro:ProPro]- (fly2 {txid :"txid7227"})
    WITH flyCount, bsubCount, drerioCount, goCount, COUNT(flyProPro)/2 AS flyProProCount
    match (bsub1 {txid :"txid224308"}) -[bsubProPro:ProPro]- (bsub2 {txid :"txid224308"})
    WITH flyCount, bsubCount, drerioCount, goCount, flyProProCount, COUNT(bsubProPro)/2 AS bsubProProCount
    match (drerio1 {txid :"txid7955"}) -[drerioProPro:ProPro]- (drerio2 {txid :"txid7955"})
    WITH flyCount, bsubCount, drerioCount, goCount, flyProProCount, bsubProProCount, COUNT(drerioProPro)/2 AS drerioProProCount
    match (fly1 {txid :"txid7227"}) -[flyReg:Reg]-&gt; (fly2 {txid :"txid7227"})
    WITH flyCount, bsubCount, drerioCount, goCount, flyProProCount, bsubProProCount, drerioProProCount, COUNT(flyReg) AS flyRegCount
    match (bsub1 {txid :"txid224308"}) -[bsubReg:Reg]-&gt; (bsub2 {txid :"txid224308"})
    WITH flyCount, bsubCount, drerioCount, goCount, flyProProCount, bsubProProCount, drerioProProCount, flyRegCount, COUNT(bsubReg) AS bsubRegCount
    match (drerio1 {txid :"txid7955"}) -[drerioReg:Reg]-&gt; (drerio2 {txid :"txid7955"})
    WITH flyCount, bsubCount, drerioCount, goCount, flyProProCount, bsubProProCount, drerioProProCount, flyRegCount, bsubRegCount, COUNT(drerioReg) AS drerioRegCount
    match (go1:go_term) -[goGo:GoGo]- (go2:go_term)
    WITH flyCount, bsubCount, drerioCount, goCount, flyProProCount, bsubProProCount, drerioProProCount, flyRegCount, bsubRegCount, drerioRegCount, COUNT(goGo)/2 AS goGoCount
    match (fly:protein {txid :"txid7227"}) -[flyProGo:ProGo]- (go)
    WITH flyCount, bsubCount, drerioCount, goCount, flyProProCount, bsubProProCount, drerioProProCount, flyRegCount, bsubRegCount, drerioRegCount, goGoCount, COUNT(flyProGo) AS flyProGoCount
    match (bsub:protein {txid :"txid224308"}) -[bsubProGo:ProGo]- (go)
    WITH flyCount, bsubCount, drerioCount, goCount, flyProProCount, bsubProProCount, drerioProProCount, flyRegCount, bsubRegCount, drerioRegCount, goGoCount, flyProGoCount, COUNT(bsubProGo) AS bsubProGoCount
    match (drerio:protein {txid :"txid7955"}) -[drerioProGo:ProGo]- (go)
    WITH flyCount, bsubCount, drerioCount, goCount, flyProProCount, bsubProProCount, drerioProProCount, flyRegCount, bsubRegCount, drerioRegCount, goGoCount, flyProGoCount, bsubProGoCount, COUNT(drerioProGo) AS drerioProGoCount
    RETURN flyCount, flyProProCount, flyProGoCount, flyRegCount, bsubCount, bsubProProCount, bsubProGoCount, bsubRegCount, drerioCount, drerioProProCount, drerioProGoCount, drerioRegCount, goCount, goGoCount
    ```
</code></pre>
<p>You should get the following output:</p>
<pre><code>    ```
    ╒════════╤══════════════╤═════════════╤═══════════╤═════════╤═══════════════╤══════════════╤════════════╤═══════════╤═════════════════╤════════════════╤══════════════╤═══════╤═════════╕
    │flyCount│flyProProCount│flyProGoCount│flyRegCount│bsubCount│bsubProProCount│bsubProGoCount│bsubRegCount│drerioCount│drerioProProCount│drerioProGoCount│drerioRegCount│goCount│goGoCount│
    ╞════════╪══════════════╪═════════════╪═══════════╪═════════╪═══════════════╪══════════════╪════════════╪═══════════╪═════════════════╪════════════════╪══════════════╪═══════╪═════════╡
    │12823   │233054        │492331       │17530      │3163     │6441           │78015         │5634        │16606      │45003            │133619          │25960         │42092  │66168    │
    └────────┴──────────────┴─────────────┴───────────┴─────────┴───────────────┴──────────────┴────────────┴───────────┴─────────────────┴────────────────┴──────────────┴───────┴─────────┘
    ```
</code></pre>
<h2 id="useful-commands">Useful Commands</h2>
<ul>
<li>
<p>Delete nodes:
<code>MATCH (n:protein {txid: "example", species: "example"}) DETACH DELETE n</code></p>
</li>
<li>
<p>Drop constraints:
<code>DROP CONSTRAINT constraint</code></p>
</li>
<li>
<p>Drop graph projection:
<code>CALL gds.graph.drop('proGoGraph') YIELD graphName</code></p>
</li>
<li>
<p>Show database information:
<code>:schema</code></p>
</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href=".." class="btn btn-neutral float-left" title="Home"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../data-version/" class="btn btn-neutral float-right" title="Data Log & Version">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href=".." style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../data-version/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
